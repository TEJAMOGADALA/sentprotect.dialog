function itemSendHandler(n){var e=n.mailboxItem,t=e.attachments,o=e.to.map((function(n){return n.split("@")[1]}));o.some((function(n){return!isInternalDomain(n)}))&&t.length>0?(n.completed({allowEvent:!1}),showAlert(t,o)):n.completed({allowEvent:!0})}function isInternalDomain(n){return["yourcompany.com"].includes(n)}function showAlert(n,e){var t=n.map((function(n){return n.name})).join(", "),o=e.join(", "),d='\n      <div id="alertModal" style="padding: 20px; background: white; border: 1px solid #ccc; border-radius: 5px; width: 300px;">\n          <h3>Warning: External Email</h3>\n          <p>You are about to send an email with the following attachments:</p>\n          <p><strong>'.concat(t,"</strong></p>\n          <p>To external domains: <strong>").concat(o,'</strong></p>\n          <button id="deferButton">Defer Sending</button>\n          <button id="sendButton">Send Anyway</button>\n      </div>\n  ');document.body.insertAdjacentHTML("beforeend",d),document.getElementById("deferButton").onclick=function(){document.getElementById("alertModal").remove()},document.getElementById("sendButton").onclick=function(){document.getElementById("alertModal").remove(),eventArgs.completed({allowEvent:!0})}}Office.onReady((function(n){n.host===Office.HostType.Outlook&&Office.context.mailbox.addHandlerAsync(Office.EventType.ItemSend,itemSendHandler)}));